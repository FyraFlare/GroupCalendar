<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="fullcalendar/fullcalendar.css"/>
<link rel="stylesheet" href="style.css"/>
<script src="fullcalendar/lib/jquery.min.js"></script>
<script src="fullcalendar/lib/moment.min.js"></script>
<script src="fullcalendar/fullcalendar.js"></script>
<script src="dashboardFunctions.js" type="text/javascript"></script>
<script src="myFunctions.js" type="text/javascript"></script>
</head>
    <div class="MainCalContainer">
        <div class="CalContainer" >
            <div id="Calendar"></div>
        </div>
        <div id="Dashboard" script="dashboardFunctions.js" >
            <div id="DashIcon" onclick="loadDashboard();">Dashboard </div> <br><br> 
            <div id="DashContent" >
                <div id="Groups" onclick="printEvents($('#Calendar').fullCalendar('clientEvents')); return false;"> Groups <hr/> </div>
                <div id="Message"> Message <hr/> </div>
            </div>
        </div>
    </div>
<script>
    $(document).ready(function() {
        var date = new Date();
        var d = date.getDate();
        var m = date.getMonth();
        var y = date.getFullYear();

        var calendar = $('#Calendar').fullCalendar({
			aspectRatio: 2,
			fixedWeekCount: false,    
			editable: true,
			events: "http://localhost/Group_Calendar/fetchEvents.php",
			// Convert the allDay from string to boolean
			eventRender: function(event, element, view) {
				if (event.allDay === 'true') {
					event.allDay = true;
				} 
				else {
					event.allDay = false;
				}
			},
			selectable: true,
			selectHelper: true,
			select: function(start, end, allDay) {
				var title = prompt('Event Title:');
				var allDay = confirm('Is this an All Day Event?');
				console.log(allDay);
				if (title) {
					var start = $.fullCalendar.moment(start).format();
					var end = $.fullCalendar.moment(end).format();
					$.ajax({
						url: 'http://localhost/Group_Calendar/addEvent.php',
						data: 'title='+ title+'&start='+ start +'&end='+ end +'&url='+ allDay ,
						type: "POST",
						success: function(json) {
							alert('Added Successfully');
						}
					});
					$('#Calendar').fullCalendar('renderEvent', {title: title, start: start, end: end, allDay: allDay}, true);
				}
				$('#Calendar').fullCalendar('unselect');
			},
			editable: true,
			eventDrop: function(event, delta) {
				var start = $.fullCalendar.moment(start).format();
				var end = $.fullCalendar.moment(end).format();
				$.ajax({
					url: 'http://localhost/Group_Calendar/updateEvent.php',
					data: 'title='+ event.title+'&start='+ start +'&end='+ end +'&id='+ event.id ,
					type: "POST",
					success: function(json) {
						alert("Updated Successfully");
					}
				});
			},
			eventResize: function(event) {
				var start = $.fullCalendar.moment(start).format();
				var end = $.fullCalendar.moment(end).format();
				$.ajax({
					url: 'http://localhost/Group_Calendar/updateEvent.php',
					data: 'title='+ event.title+'&start='+ start +'&end='+ end +'&id='+ event.id ,
					type: "POST",
					success: function(json) {
						alert("Updated Successfully");
					}
				});
			},
			header: {
				left: 'prev,next today',
				center: 'title',
				right: 'month,agendaWeek,agendaDay'
			}
		});
});

</script>



</html>